<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<link id="favicon" rel="shortcut icon" type="image/png" href="data:image/png;base64,....==" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/css/foundation.min.css" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/js/foundation.min.js" crossorigin="anonymous"></script>
	<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
	<title>Items</title>
	<style>
		
	</style>
	<script src="https://unpkg.com/vue@next"></script> <!-- https://v3.vuejs.org/guide/installation.html#cdn -->
	<!-- <script src="vue.js"></script> -->
</head>
<body>
	<div id="app">
		<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
			<button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
			<div class="title-bar-title">Menu</div>
		  </div>

		<div class = "medium-6 cell">
			<h2>Item</h2>
		</div>
		

		<form>
			  <div class="grid-x grid-padding-x">
				<div class="medium-6 cell">
				  <label>UserID
					<input type="text" placeholder="user_id">
				  </label>
				</div>
				<div class="medium-6 cell">
				  <label>keywords
					<input type="text" placeholder="Keywords">
				  </label>
				</div>
				<div class="medium-6 cell">
					<label>Description
					  <input type="text" placeholder="Description">
					</label>
				  </div>
				<div class="medium-6 cell">
					<label>Image URL
					  <input type="text" placeholder="Image">
					</label>
				  </div>
				<div class="medium-6 cell">
					<label>lat 
					  <input type="text" placeholder="lat">
					</label>
				  </div>
				<div class="medium-6 cell">
					<label>lon
					  <input type="text" placeholder="lon">
					</label>
				</div>
				<div class="medium-6 cell">
					<input type="submit" class="button" value="Submit">
				</div>

			  </div>
		  </form>

		  <div class = "medium-6 cell">
			<h2>Items</h2>
		</div>
		
		<ul>
			<li v-for="item in items">
				<div class="card" style="width: 250px;">
					<div class="card-divider">
					 Item
					</div>
					<img src="">
					<div class="card-section">
					  <button class = "alert button" @click="deleteItem(item.id)">Remove</button>
				</div>
			</li>
		</ul>
	</div>
<script type="module">
	const DEFAULT_API = '/api/v1';  // default to current http(s)://currentHost:currentPort/api/v1'
 	const urlParams = new URLSearchParams(window.location.search);
 	const urlAPI = (urlParams.get('api') || DEFAULT_API).replace(/\/$/, '');
	const RootComponent = {
	  data() {
		return {
			item: {
				id: '',
				user_id: '',
				keywords: '',
				image:'',
				description: '',
				lat: '',
				lon: '',
				date_from: '',
				date_to:''
			},
			items:[],
		}
	  },
	  created() {
		this.clearInput()
		this.updateItem()
	  },
	  components: {
	  },
	  methods: {
		updateItem() {
			fetch(`${urlAPI}/items`, {
			})
				.then(response => response.json())
				.then(json => {this.items = json})
			.catch(err => console.error(err))
		},
		clearInput() {
			this.item = {...this.item, ...{
				id: undefined,
				notes: undefined,
				image:undefined,
				description: undefined,
				lat:undefined,
				lon:undefined
			}}
		},
		addItem() {
			fetch(`${urlAPI}/item`, {
				method: 'POST',
				headers: {'Content-Type': 'application/json'},
				body: JSON.stringify(this.item),
			})
				.then(response => response.json())
				.then(()=>this.clearInput())
				.then(()=>this.updateItem())
			.catch(err => console.error(err));
		},
		deleteItem(id) {
			etch(`${urlAPI}/item/${id}`, {
				method: 'DELETE',
			})
				.then(()=>this.updateItem())
			.catch(err => console.error(err));
		}
	  },
	}
	const app = Vue.createApp(RootComponent)
	const vm = app.mount('#app')
	
</script>

</body>
</html>